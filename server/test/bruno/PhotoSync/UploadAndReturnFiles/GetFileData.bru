meta {
  name: GetFileData
  type: http
  seq: 8
}

get {
  url: {{HOST}}/file_data?offset=0&count=10
  body: none
  auth: inherit
}

params:query {
  offset: 0
  count: 10
}

headers {
  Authorization: {{TOKEN}}
}

assert {
  res.status: eq 200
  res.headers["access-control-allow-origin"]: eq {{ALLOWED_ORIGIN}}
}

tests {
  const rawJpgBase64 = bru.getCollectionVar("RAW_JPG_BASE64")
  const exifJpgBase64 = bru.getCollectionVar("EXIF_JPG_BASE64")
  const iptcJpgBase64 = bru.getCollectionVar("IPTC_JPG_BASE64")
  const xmpJpgBase64 = bru.getCollectionVar("XMP_JPG_BASE64")
  test("should return proper file data", function(){
    expect(res.getBody()).to.eql(
    [
      {
        creation_date : "2025.08.11 15:40:00",
        filename : "raw.jpg",
        id: "4",
        mime_type: "image/jpeg",
        size: "2439",
        thumbnail: rawJpgBase64
      },
      {
        creation_date : "2023.06.07 12:30:45",
        filename : "exif.jpg",
        id: "2",
        mime_type: "image/jpeg",
        size: "3474",
        thumbnail: exifJpgBase64
      },
      {
        creation_date : "2022.03.01 21:37:00",
        filename : "iptc.jpg",
        id: "1",
        mime_type: "image/jpeg",
        size: "3240",
        thumbnail: iptcJpgBase64
      },
      {
        creation_date : "2007.12.20 00:24:13",
        filename : "xmp.jpg",
        id: "3",
        mime_type: "image/jpeg",
        size: "6542",
        thumbnail: xmpJpgBase64
      },
    ]
    )
  })
}

settings {
  encodeUrl: true
}
